name: PyPI Release

on:
  push:
    branches:
      - test_update_package

jobs:
  release:
    name: Release New Version
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
        
      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: 3.x
      
      - name: Update version number
        run: |
          cd package/classification_model
          VERSION=$(cat classification_model/VERSION)
          MAJOR=$(echo $VERSION | cut -d. -f1)
          MINOR=$(echo $VERSION | cut -d. -f2)
          PATCH=$(echo $VERSION | cut -d. -f3)
          PATCH=$((PATCH + 1))
          NEW_VERSION="$MAJOR.$MINOR.$PATCH"
          echo $NEW_VERSION > classification_model/VERSION
      
    #   - name: Run training pipeline
    #     run: tox -e train
      
    #   - name: Clear build cache
    #     run: rm -rf build dist *.egg-info
      
    #   - name: Create and publish release
    #     run: |
    #       python setup.py sdist bdist_wheel
    #       twine upload dist/*
